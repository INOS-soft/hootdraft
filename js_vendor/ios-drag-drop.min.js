!function(t){function e(e){e=e||{},l=navigator.userAgent.match(/OS [1-4](?:_\d+)+ like Mac/)?"page":"client";var n=t.createElement("div"),i="draggable"in n,s="ondragstart"in n&&"ondrop"in n,g=!(i||s)||/iPad|iPhone|iPod|Android/.test(navigator.userAgent);d((g?"":"not ")+"patching html5 drag drop"),g&&(e.enableEnterLeave||(a.prototype.synthesizeEnterLeave=o),t.addEventListener("touchstart",r))}function a(t,e){this.dragData={},this.dragDataTypes=[],this.dragImage=null,this.dragImageTransform=null,this.dragImageWebKitTransform=null,this.el=e||t.target,d("dragstart"),this.dispatchDragStart(),this.createDragImage(),this.listen()}function r(e){var r=e.target;do if(r.draggable===!0){if(!r.hasAttribute("draggable")&&"a"==r.tagName.toLowerCase()){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,r.ownerDocument.defaultView,1,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,0,null),r.dispatchEvent(n),d("Simulating click to anchor")}e.preventDefault(),new a(e,r)}while((r=r.parentNode)&&r!==t.body)}function n(e,a){var r=a.changedTouches[0],n=t.elementFromPoint(r[l+"X"],r[l+"Y"]);return n}function i(t,e,a,r){return r&&(a=a.bind(r)),t.addEventListener(e,a),{off:function(){return t.removeEventListener(e,a)}}}function s(t,e,a,r){function n(r){return a(r),t.removeEventListener(e,n)}return r&&(a=a.bind(r)),t.addEventListener(e,n)}function g(t,e){if(1==t.nodeType){e.removeAttribute("id"),e.removeAttribute("class"),e.removeAttribute("style"),e.removeAttribute("draggable");for(var a=window.getComputedStyle(t),r=0;r<a.length;r++){var n=a[r];e.style.setProperty(n,a.getPropertyValue(n),a.getPropertyPriority(n))}}if(t.hasChildNodes())for(var r=0;r<t.childNodes.length;r++)g(t.childNodes[r],e.childNodes[r])}function d(t){console.log(t)}function h(t){return 0===t.length?0:t.reduce(function(t,e){return e+t},0)/t.length}function o(){}d=o;var l;a.prototype={listen:function(){function e(t){this.dragend(t,t.target),a.call(this)}function a(){return d("cleanup"),this.dragDataTypes=[],null!=this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImage=null,this.dragImageTransform=null,this.dragImageWebKitTransform=null),this.el=this.dragData=null,[r,n,s].forEach(function(t){return t.off()})}var r=i(t,"touchmove",this.move,this),n=i(t,"touchend",e,this),s=i(t,"touchcancel",a,this)},move:function(t){var e=[],a=[];[].forEach.call(t.changedTouches,function(t,r){e.push(t.pageX),a.push(t.pageY)});var r=h(e)-parseInt(this.dragImage.offsetWidth,10)/2,n=h(a)-parseInt(this.dragImage.offsetHeight,10)/2;this.translateDragImage(r,n),this.synthesizeEnterLeave(t)},hideDragImage:function(){this.dragImage&&"none"!=this.dragImage.style.display&&(this.dragImageDisplay=this.dragImage.style.display,this.dragImage.style.display="none")},showDragImage:function(){this.dragImage&&(this.dragImage.style.display=this.dragImageDisplay?this.dragImageDisplay:"block")},translateDragImage:function(t,e){var a=" translate("+t+"px,"+e+"px)";null!==this.dragImageWebKitTransform&&(this.dragImage.style["-webkit-transform"]=this.dragImageWebKitTransform+a),null!==this.dragImageTransform&&(this.dragImage.style.transform=this.dragImageTransform+a)},synthesizeEnterLeave:function(t){this.hideDragImage();var e=n(this.el,t);this.showDragImage(),e!=this.lastEnter&&(this.lastEnter&&this.dispatchLeave(t),this.lastEnter=e,this.lastEnter&&this.dispatchEnter(t)),this.lastEnter&&this.dispatchOver(t)},dragend:function(e){d("dragend"),this.lastEnter&&this.dispatchLeave(e),this.hideDragImage();var a=n(this.el,e);this.showDragImage(),a?(d("found drop target "+a.tagName),this.dispatchDrop(a,e)):d("no drop target");var r=t.createEvent("Event");r.initEvent("dragend",!0,!0),this.el.dispatchEvent(r)},dispatchDrop:function(e,a){var r=t.createEvent("Event");r.initEvent("drop",!0,!0);var n=a.changedTouches[0],i=n[l+"X"],g=n[l+"Y"];r.offsetX=i-e.x,r.offsetY=g-e.y,r.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)},r.preventDefault=function(){}.bind(this),s(t,"drop",function(){d("drop event not canceled")},this),e.dispatchEvent(r)},dispatchEnter:function(e){var a=t.createEvent("Event");a.initEvent("dragenter",!0,!0),a.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)};var r=e.changedTouches[0];a.pageX=r.pageX,a.pageY=r.pageY,this.lastEnter.dispatchEvent(a)},dispatchOver:function(e){var a=t.createEvent("Event");a.initEvent("dragover",!0,!0),a.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)};var r=e.changedTouches[0];a.pageX=r.pageX,a.pageY=r.pageY,this.lastEnter.dispatchEvent(a)},dispatchLeave:function(e){var a=t.createEvent("Event");a.initEvent("dragleave",!0,!0),a.dataTransfer={types:this.dragDataTypes,getData:function(t){return this.dragData[t]}.bind(this)};var r=e.changedTouches[0];a.pageX=r.pageX,a.pageY=r.pageY,this.lastEnter.dispatchEvent(a),this.lastEnter=null},dispatchDragStart:function(){var e=t.createEvent("Event");e.initEvent("dragstart",!0,!0),e.dataTransfer={setData:function(t,e){return this.dragData[t]=e,-1==this.dragDataTypes.indexOf(t)&&(this.dragDataTypes[this.dragDataTypes.length]=t),e}.bind(this),dropEffect:"move"},this.el.dispatchEvent(e)},createDragImage:function(){this.dragImage=this.el.cloneNode(!0),g(this.el,this.dragImage),this.dragImage.style.opacity="0.5",this.dragImage.style.position="absolute",this.dragImage.style.left="0px",this.dragImage.style.top="0px",this.dragImage.style["z-index"]="999999",this.dragImage.style["pointer-events"]="none";var e=this.dragImage.style.transform;"undefined"!=typeof e&&(this.dragImageTransform="","none"!=e&&(this.dragImageTransform=e.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"")));var a=this.dragImage.style["-webkit-transform"];"undefined"!=typeof a&&(this.dragImageWebKitTransform="","none"!=a&&(this.dragImageWebKitTransform=a.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""))),this.translateDragImage(-9999,-9999),t.body.appendChild(this.dragImage)}},e(window.iosDragDropShim)}(document);